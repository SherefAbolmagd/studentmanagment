"use strict";var rootURL="http://localhost/studentmanagment/api/cars";function addDataToTableRow(e,t,o,a,n,r){var i=$.parseHTML("<tr style='color: "+o+"' id='"+e+"'></tr>"),l=$.parseHTML("<td class='index-column'></td>");$(l).data("Model",e),$(l).data("Name",t),$(l).data("Color",o),$(l).data("Type",a),$(l).data("Capacity",n),$(l).data("Speed",r);var s=$.parseHTML("<td></td>");$(s).html(e);var d=$.parseHTML("<td></td>");$(d).html("<a href='#'>"+t+"</a>");var c=$.parseHTML("<td></td>");$(c).html("<a href='#'>"+o+"</a>");var u=$.parseHTML("<td></td>");$(u).html(a);var m=$.parseHTML("<td></td>");$(m).html(n);var h=$.parseHTML("<td></td>");$(h).html(r);var p=$.parseHTML("<td></td>");$(p).html("<a href='#'><i class='fa fa-trash' style='font-size:25px;color:red'></i></a>"),$(i).append(s),$(i).append(d),$(i).append(c),$(i).append(u),$(i).append(m),$(i).append(h),$(i).append(p),$("#tbl1 tbody").append(i)}function loginFormToJSON(){return JSON.stringify({login:$("#inputLogin").val(),password:$("#inputPassword").val()})}function insertFormToJSON(){return JSON.stringify({modelNumber:$("#Model").val(),carName:$("#Name").val(),color:$("#Color").val(),carType:$("#Type").val(),tankCapacity:$("#Capacity").val(),topSpeed:$("#Speed").val()})}function editFormToJSON(){return JSON.stringify({modelNumber:$("#inputEditIsbn").val(),carName:$("#inputEditTitle").val(),color:$("#inputEditAuthorName").val(),carType:$("#inputEditPublisher").val(),tankCapacity:$("#inputEditPublishingDate").val(),topSpeed:$("#inputEditPrice").val()})}function editAuthorFormToJSON(){return JSON.stringify({color:$("#color").val()})}function getTDValue(e,t){return document.getElementById(e).childNodes[t].innerHTML}function setTDValue(e,t,o){document.getElementById(e).childNodes[t].innerHTML=o}$(function(){$.ajaxPrefilter(function(e,t,o){o.setRequestHeader("AUTH-TOKEN",sessionStorage.authToken)}),sessionStorage.authToken?($("#logindiv").hide(),$("#navmember").fadeIn(1e3),$("#loggeddiv").fadeIn(1e3),$("#tokeninfo").html("REST Authentication Token: "+sessionStorage.authToken),$("#username").html("Welcome "+sessionStorage.userName),$("#nocars").html(sessionStorage.carnum)):($("#logindiv").fadeIn(1e3),$("#navmember").hide(),$("#loggeddiv").hide()),$("#formlogin").submit(function(e){return e.preventDefault(),values=loginFormToJSON(),$.ajax({type:"POST",cache:!1,contentType:"application/json",url:"http://localhost/studentmanagment/api/auth",dataType:"json",data:values,success:function(e){sessionStorage.authToken=e.token,sessionStorage.userName=e.name,sessionStorage.carnum=e.cars.length,$("#logindiv").hide(),$("#navmember").fadeIn(1e3),$("#loggeddiv").fadeIn(1e3),$("#tokeninfo").html("REST Token: "+sessionStorage.authToken),$("#username").html("Welcome "+sessionStorage.userName),$("#nocars").html(sessionStorage.carnum),$("#isbn").val(""),$("#title").val(""),$("#author").val(""),$("#publisher").val(""),$("#publishdate").val(""),$("#price").val(""),routie("home")},error:function(){alert("Anta sproblems while processing JSON file.")}}),!1}),routie({"":function(){$("#wellcrud").hide(),$("#wellhome").fadeIn(1e3),$("#lihome").addClass("active"),$("#licrud").removeClass("active"),routie("")},home:function(){$("#wellcrud").hide(),$("#wellhome").fadeIn(1e3),$("#lihome").addClass("active"),$("#licrud").removeClass("active")},crud:function(){$("#wellhome").hide(),$("#wellcrud").fadeIn(1e3),$("#licrud").addClass("active"),$("#lihome").removeClass("active"),$("#isbn").val(""),$("#title").val(""),$("#author").val(""),$("#publisher").val(""),$("#publishdate").val(""),$("#price").val(""),$("#tbl1 tbody").empty(),$.ajax({type:"GET",url:rootURL,dataType:"json",success:function(e){if(e.error)bootbox.alert("Authentication Token Invalid!",function(){$("#logindiv").fadeIn(1e3),$("#navmember").hide(),$("#loggeddiv").hide(),sessionStorage.removeItem("authToken"),sessionStorage.removeItem("userName"),routie("")});else for(var t in e)addDataToTableRow(e[t].modelNumber,e[t].carName,e[t].color,e[t].carType,e[t].tankCapacity,e[t].topSpeed)},error:function(){alert("An error occurred while processing JSON file. MAIN ERROR!!!!")}})}}),$("#crud").click(function(){$("#wellhome").hide(),$("#wellcrud").fadeIn(1e3),$("#licrud").addClass("active"),$("#lihome").removeClass("active"),routie("crud")}),$("#home").click(function(){$("#wellcrud").hide(),$("#wellhome").fadeIn(1e3),$("#lihome").addClass("active"),$("#licrud").removeClass("active"),routie("home")}),$("#mainlink").click(function(){$("#wellcrud").hide(),$("#wellhome").fadeIn(1e3),$("#lihome").addClass("active"),$("#licrud").removeClass("active"),routie("home")}),$("#btnhide").click(function(){bootbox.confirm("Are you sure want to hide Hello?",function(e){e&&$("#hello").fadeOut(1e3)})}),$("#btnshow").click(function(){bootbox.confirm("Are you sure want to show Hello?",function(e){e&&$("#hello").fadeIn(1e3)})}),$("#tbl1").on("click","span",function(){var t=$(this).parent().parent().parent(),o=$(t)[0].id;bootbox.confirm("Are you sure?",function(e){e&&$.ajax({type:"DELETE",url:rootURL+"/"+o,dataType:"json",success:function(e){"success"==e.deleteStatus&&$(t).fadeOut("slow","swing")},error:function(){alert("An error occurred while processing JSON file.")}})})}),$("#tbl1").on("mouseenter","td",function(e){2==$(this).index()&&($(this).css("cursor","pointer"),$(this).css("font-weight","bold"))}).on("mouseleave","td",function(){2==$(this).index()&&($(this).css("cursor","default"),$(this).css("font-weight","normal"))}),$("#tbl1").on("click","td",function(e){var t,o,a,n,r,i,l,s,d=$(this).index(),c=$(this).parent(),u=$(c).children().eq(0);return 1==d&&($("#bookinfo").hide(),t=u[0].innerHTML,$("#inputEditIsbn").val(t),o=(u=$(c).children().eq(1).children(0))[0].innerHTML,$("#inputEditTitle").val(o),a=(u=$(c).children().eq(2).children(0))[0].innerHTML,$("#inputEditAuthorName").val(a),n=(u=$(c).children().eq(3))[0].innerHTML,$("#inputEditPublisher").val(n),r=(u=$(c).children().eq(4))[0].innerHTML,$("#inputEditPublishingDate").val(r),i=(u=$(c).children().eq(5))[0].innerHTML,$("#inputEditPrice").val(i),$("#bookinfo").fadeIn(1e3)),2==d&&(l=$(this).children(0).html(),s=this,bootbox.dialog({title:"Edit Car Color",message:'<form class="form-horizontal"> <div class="form-group">   <label for="color" class="col-sm-2 control-label">Car Color</label>   <div class="col-sm-10">     <input type="text" class="form-control" id="color" name="color" value="'+l+'">   </div> </div></form>',buttons:{success:{label:"Save",className:"btn-success",callback:function(){var e=$(u).html();$.ajax({type:"PUT",contentType:"application/json",url:rootURL+"/updatecolor/"+e,dataType:"json",data:editAuthorFormToJSON(),success:function(e){var t;"success"==e.updateStatus&&(t=$("#color").val(),$(s).html(t),$(u).data("color",t)),location.reload()},error:function(){alert("An error occurred while processing JSON file.")}})}}}})),e.preventDefault(),!1}),$("#btnclosebookinfo").click(function(e){return $("#bookinfo").fadeOut(1e3),e.preventDefault(),!1}),$("#form1").submit(function(e){e.preventDefault(),$.ajax({type:"POST",contentType:"application/json",url:rootURL,dataType:"json",data:insertFormToJSON(),success:function(e){e.error?bootbox.alert("Authentication Token Invalid!",function(){$("#logindiv").fadeIn(1e3),$("#navmember").hide(),$("#loggeddiv").hide(),sessionStorage.removeItem("authToken"),sessionStorage.removeItem("userName"),routie("")}):"success"==e.insertStatus?(addDataToTableRow(e.modelNumber,e.carName,e.color,e.carType,e.tankCapacity,e.topSpeed),$("#Model").val(""),$("#Name").val(""),$("#Color").val(""),$("#Type").val(""),$("#Capacity").val(""),$("#Speed").val(""),bootbox.alert("New book inserted!",function(){})):"failed"==e.insertStatus&&(bootbox.alert("REST operation error: "+e.errorMessage,function(){}),$("#Model").val(""),$("#Name").val(""),$("#Color").val(""),$("#Type").val(""),$("#Capacity").val(""),$("#Speed").val(""))},error:function(){alert("An error occurred while processing JSON file.")}})}),$("#frmedit").submit(function(e){e.preventDefault();var n=$("#inputEditIsbn").val();$.ajax({type:"PUT",contentType:"application/json",url:rootURL+"/"+n,dataType:"json",data:editFormToJSON(),success:function(e){var t,o,a;e.error?bootbox.alert("Authentication Token Invalid!",function(){$("#logindiv").fadeIn(1e3),$("#navmember").hide(),$("#loggeddiv").hide(),sessionStorage.removeItem("authToken"),sessionStorage.removeItem("userName"),routie("")}):"success"==e.updateStatus?(bootbox.alert("Car Editing Success!",function(){location.reload()}),t=$("#tr"+n).children().eq(0),$(t).data("isbn",e.isbn),$(t).data("title",e.title),$(t).data("author",e.author),$(t).data("publisher",e.publisher),$(t).data("publishingdate",e.publishingdate),$(t).data("price",e.price),o=$("#tr"+n).children().eq(1),$(o).html("<a href='#'>"+$("#inputEditTitle").val()+"</a>"),a=$("#tr"+n).children().eq(2),$(a).html($("#inputEditAuthorName").val())):"failed"==e.updateStatus&&bootbox.alert("REST operation error: "+e.errorMessage,function(){})},error:function(){alert("An error occurred while processing JSON file.")}})}),$("#hreflogout").click(function(){$("#logindiv").fadeIn(1e3),$("#navmember").hide(),$("#loggeddiv").hide(),sessionStorage.removeItem("authToken"),sessionStorage.removeItem("userName"),sessionStorage.removeItem("carnum"),routie("")})});